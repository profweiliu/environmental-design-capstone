---
title: "Lab 06 Dashboard using Tableau and Miscellaneous"
subtitle: "RE 519 Data Analytics and Visualization | Autumn 2025"
author: "" #remember to add to your name when you submit the lab
date: ""
output: 
  cleanrmd::html_document_clean:
    theme: almond
    toc: true 
    toc_depth: 3
    css: custom.css
    mathjax: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    md_extensions: +tex_math_dollars+tex_math_single_backslash   
    df_print: paged 
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

------------------------------------------------------------------------

<!-- start of the main lab content -->

The due day for each lab can be found on the [course wesbite](https://www.yuehaoyu.com/data-analytics-visualization/). The submission should include Rmd, html, and any other files required to rerun the codes. For Tableau, submit your [**Tableau packaged workbook (.tbwx)**](https://help.tableau.com/current/pro/desktop/en-us/save_savework_packagedworkbooks.htm) This will include any excel files that you attach so that when you share the file anyone with Tableau can open it!

From Lab 4, the use of any generative AI tool (ChatGPT, Copilot, etc.) is **allowed**. But, I still encourage you to write codes by yourself and use AI tools as a way to debug and explore new knowledge. More information about [Academic Integrity](https://www.yuehaoyu.com/data-analytics-visualization/syllabus/#academic-integrity) and [the Use of AI](https://www.yuehaoyu.com/data-analytics-visualization/syllabus/#use-of-ai).

------------------------------------------------------------------------

## Lab 06-A: Dashboard using Tableau

### ðŸ“š TODO: Tableau Dashboard for Project Datasets

**16 points**

The purpose of this lab is to use Excel/R for data preprocessing and Tableau Worksheet + Dashboard to conduct exploratory data analysis and initial visualization on the topic you are interested in. The assignment can be seen as the first step for the [Data Analytics and Visualization Projects](https://www.yuehaoyu.com/data-analytics-visualization/projects/). Note: if you plan to **use Tableau Dashboard for your final project**, you are expected to make significant progress after this lab, both in analytical depth and dashboard design.

#### Requirements

Basic requirements for this lab:

- Create at least five individual visualizations worksheets
- Create one or two interactive dashboards
  - Add a title, description, and data source citation
  - [Format your work](https://help.tableau.com/current/pro/desktop/en-us/formatting.htm) and ensure proper alignment, consistent colors, and readable labels, 
  - Make the dashboard interactive using, for example,  [parameters](https://help.tableau.com/current/pro/desktop/en-us/parameters_create.htm), [filter](https://help.tableau.com/current/pro/desktop/en-us/actions_filter.htm), [highlights](https://help.tableau.com/current/pro/desktop/en-us/actions_highlight.htm), [URL actions](https://help.tableau.com/current/pro/desktop/en-us/actions_url.htm), [set actions](https://help.tableau.com/current/pro/desktop/en-us/actions_sets.htm).

You are encourage to explore some advanced functions in Tableau. [Tableau Desktop and Web Authoring Help](https://help.tableau.com/current/pro/desktop/en-us/default.htm) is always the most helpful material to learn Tableau. 

- [Create Parameters](https://help.tableau.com/current/pro/desktop/en-us/parameters_create.htm)
- [Create Custom Fields with Calculations](https://help.tableau.com/current/pro/desktop/en-us/calculations_calculatedfields.htm)
- [Create Sets](https://help.tableau.com/current/pro/desktop/en-us/sortgroup_sets_create.htm)
- [Dashboards](https://help.tableau.com/current/pro/desktop/en-us/dashboards.htm)
- [Build Advanced Chart Types](https://help.tableau.com/current/pro/desktop/en-us/analytics_howtos.htm)

The results of Tableau visualization should be reflected and briefly discussed in your [project proposal](https://www.yuehaoyu.com/data-analytics-visualization/projects/#project-proposal), providing evidence of your initial data exploration and research direction.

#### Submission

This is a **group assignment** and each group only need to submit once. 

Submit your [**Tableau packaged workbook
(.tbwx)**](https://help.tableau.com/current/pro/desktop/en-us/save_savework_packagedworkbooks.htm)
This will include any data files that you attach so that when you share
the file anyone with Tableau can open it!

Or, submit the link to your Tableau Public page via Canvas.

You can also upload to GitHub and submit the link to your repository. Please be sure to make the repository public/visible. For Lab 4-9, the use of any generative AI tool (ChatGPT, Copilot, etc.) is allowed. 

#### Late Days

All group members will consume late days if the submission is late.

------------------------------------------------------------------------

## Lab 06-B: Command Line, Virtual Environment, and SQL (Optional)

In Section B, we will introduce three topics related to data science: command line, environment and SQL. This section is optional, and we will not go deeper into it. The purpose of this section is to let you know what is command line, terminal, database, SQL, and why we use such tools. 

### Command Line

We often see those fancy, â€œgeekyâ€ black boxes on computer screens in movies. Those black boxes are usually **terminals**ï¼Œ **shell**, or **command-line interfaces**. They allow users to type **commands** directly to control the computer.

![Termnial in Windows System. Source: Microsoft](https://learn.microsoft.com/en-us/windows/terminal/images/tear-tab.gif)

In any computer, we have a hierarchical structure of folders (also called *directories*) and files within them. The whole file system can be visualized as a tree. Normally, we use a **Graphical User Interface (GUI)** â€” for example, clicking through Finder on macOS or File Explorer on Windows â€” to navigate among files, applications, and folders. However, we can also use a **Command Line Interface (CLI)** to navigate the same file system through text commands. For example, when we enter `ls` (means list) in Mac/Linux system terminal, we will get a list of files in the working directory. 

![File System. Source: www.techtarget.com](https://www.techtarget.com/rms/onlineImages/TT_tree.jpg)

#### Why Do We Sometimes Need Commands?

- We want to have a record of what we did
- We want to repeat the same procedure later â€” a script can store and rerun our actions automatically
- We want to use some services do not have a graphical interface
- We want to operate systems without a graphical interface, such as a sensor and server

#### Command Line Tool

Most common command line is `bash`, which is widely used in any Mac, Linux, supercomputer. (Actually, in Mac, the default shell is `zsh` but you can see it as `bash+`). The default command line in Windows is `PowerShell` - their syntax are different. `Bash` is more popular and widely used and we will use it as the example. I believe that is one of the reason that programmers like to use Mac and Linux instead of Windows. 

For Windows users, you can learn [PowerShell](https://learn.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.5) from Microsoft. Or, you can install a [Linux system using WSL](https://learn.microsoft.com/en-us/windows/wsl/install). Or, you will likely install `Git` when installing `GitHub Desktop`; `Git` will come up with `bash`. 

```{bash}
# instead of R, we have bash within the {} above
# we cannot promise the following commands can be run on Windows 
```

Most time, we should will terminal instead of Rmd. Please try those commands in terminal even through they are same actions. We will only have a look of some simple operations. 

```{bash}
pwd # print current working directory
ls # list the files/folders in the working directory
mkdir -p new_folder_bash # make a new directory; -p is an argument: no error if existing, make parent directories as needed
```

We open the folder we just created and create a new `txt` file. 

```{bash}
cd new_folder_bash # change the working directory
ls # list the files/folders in the working directory
touch using_bash.txt # create empty files
rm using_bash.txt # remove the file 
```

#### Script 

We can write these commands into a shell script file (with the `.sh` extension), for example     `create_new_folder_script.sh`. Then we can run it from the command line using:

```{bash}
bash create_new_folder_script.sh
```

#### Next Step

I donâ€™t think we have to go any deeper here.The goal of this section is simply to help you understand what command-line tools are and how they can be used to automate tasks. If you feel it is interesting, there are some comprehensive guide on `bash`: 

- [The Linux Command Line](https://linuxcommand.org/index.php).
- [The Unix Shelll Software Carpentry](https://swcarpentry.github.io/shell-novice/).

#### An Example on Data Processing using `bash`

When you download data from [Dewey Data Platform](https://www.deweydata.io), like the rental data we used in lab 4. You may receive many compressed `csv` files. In this example, we have a folder called `bash_example`, which contains 100 zipped `csv` files. We would like to unzip and merge them for future analysis or visualization. It will take amount of time and energy to do that one by one. `bash` would be super helpful. 

Even if we donâ€™t know exactly how to do this using the command line, we can simply ask AI tools like OpenAIâ€™s GPT or Googleâ€™s Gemini: â€œHow do I unzip all zip files and merge all CSV files (with the same header) into a single file using bash?â€

ChatGPT 5 gives me the following commands and it works:

```
for f in *.zip; do
  unzip -o "$f"
done
header=$(head -n 1 $(ls *.csv | head -1))
echo "$header" > merged.csv
for f in *.csv; do
  tail -n +2 "$f" >> merged.csv
done
```

### Virtual Environment

You may realize that we are using many, many, many existing packages. Meanwhile, those packages are changing and those packages are using other packages....... In other words, R (like most programming ecosystems) is built on a web of software dependencies, where one package may only work correctly with specific versions of the others --- some people call it **dependency hell**. 

![Dependency Hell. Source: Montana Low](https://miro.medium.com/v2/resize:fit:984/format:webp/0*7ezJOtYUkI5zyqWU.png)

This is why **virtual environments** are so important. They help us *record exactly which package versions were used for a project*, so that our code remains reproducible and stable, even if the global R ecosystem keeps evolving. 

In R, we use [`renv` package](https://rstudio.github.io/renv/articles/renv.html) to manage that for each project. Also, we can use general-purpose environment managers, such as [Anaconda](https://anaconda.org/anaconda/conda), which can handle dependencies across multiple languages (e.g., Python, R).

### Relational Database and SQL

For handling small datasets, like all the datasets we have used so far, storing them in simple `.csv` files works perfectly fine. However, when we start dealing with larger datasets, or data that need to be shared, updated, or queried efficiently, it becomes difficult to manage everything as separate files â€” imagine the disaster of running DXD Capitalâ€™s data system with thousands of `CSVs`. 

So, people are using **Database Management System (DBMS)** to create and manage a large amount of data. For commonly used row/column data, **relational databases** are the most widely used type of database. It organizes data into tables, where each table contains rows and columns. Different tables can be linked together through **keys**. 

- Primary Key [PK]: unique attributes.
- Foreign Key [FK]: attributes that can be used to uniquely identify a row in **another table**.

Relationships are connections among two or more entity sets. 

- one-to-one: SSN - a person who has SSN
- many-to-one: SSN - phone numbers
- many-to-many: stores - products

![Entity/Relationship Diagrams for a Relational Database. Source: Josh Errickson, Statistics, University of Michigan](https://dept.stat.lsa.umich.edu/~jerrick/courses/stat506_f23/images/rdbms.png)

#### A Quick Look of SQL 

[SQL (Structured Query Language)](https://en.wikipedia.org/wiki/SQL) is the most commonly used query language for relational databases. Let's try to use `SQL` to get query for Airbnb data within `airbnb.sqlite`, a [SQLite database](https://sqlite.org). 

```{r}
# install.packages("DBI") # you only need to install once
# install.packages("RSQLite") # you only need to install once
library(DBI)
# connect to the airbnb database
airbnb_db <- dbConnect(RSQLite::SQLite(), "airbnb.sqlite")
```

```{r}
# check the tables and fields (not important points for SQL)
dbListTables(airbnb_db)
dbListFields(airbnb_db, "airbnb")
```

We use queries to get the data we want from a database. A query is simply a command written in SQL that asks the database to return specific information.

| **SQL Command** | **Purpose**                           | **Example**                                                |
| --------------- | ------------------------------------- | ---------------------------------------------------------- |
| **SELECT**      | Retrieve data from one or more tables | SELECT * FROM my_table;                                    |
| **WHERE**       | Filter rows based on a condition      | SELECT * FROM my_table WHERE population > 100000;          |
| **ORDER BY**    | Sort results                          | SELECT * FROM my_table ORDER BY income DESC;               |
| **LIMIT**       | Restrict the number of returned rows  | SELECT * FROM my_table LIMIT 10;                           |
| **GROUP BY**    | Aggregate rows by a category          | SELECT state, AVG(income) FROM my_table GROUP BY state;    |
| **JOIN**        | Combine data from multiple tables     | SELECT * FROM city JOIN state ON city.state_id = state.id; |


```{r}
# query within "*"
# select all columns from airbnb data limit to 3 rows
dbGetQuery(airbnb_db, "SELECT * 
                       FROM airbnb 
                       LIMIT 3")
```

```{r}
# select distinct neighbourhood_group column from airbnb data limit to 3 rows
dbGetQuery(airbnb_db, "SELECT DISTINCT neighbourhood_group
                       FROM airbnb 
                       LIMIT 3")
```

```{r}
# select all columns from airbnb data and order by price limit to 3 rows
dbGetQuery(airbnb_db, "SELECT *
                       FROM airbnb 
                       ORDER BY price DESC
                       LIMIT 3")
```

```{r}
# the average price by neighborhood group and avg price above 250
dbGetQuery(airbnb_db, "SELECT neighbourhood_group, AVG(price) AS Avg_price
                       FROM airbnb 
                       GROUP BY neighbourhood_group
                       HAVING Avg_price > 250")
```

```{r}
# disconnect from the database
dbDisconnect(airbnb_db)
```

SQL is not a complicated language. But similarly to shell, I will recommend to use AI to prepare the queries unless you have a full-time job in data science. Some resources for learning SQL: 

- [SQLBolt](https://sqlbolt.com)
- [CSE 414 Introduction to Database Systems (for non-CSE Majors)](https://courses.cs.washington.edu/courses/cse414/)
- [Databases and SQL Software Carpentry](https://swcarpentry.github.io/sql-novice-survey/).

### Code Style

It is important to write efficiently that can be read by computers and **people**. In the community of `R`, we use to follow the [Tidyverse Style Guide](https://style.tidyverse.org). 

## Acknowledgement

The materials are developed by [Haoyu Yue](www.yuehaoyu.com) based
materials from [Dr. Feiyang Sun at UC San Diego](https://fsun.ucsd.edu),
Siman Ning and Christian Phillips at University of Washington, [Dr.
Charles Lanfear at University of Cambridge](https://clanfear.github.io).
